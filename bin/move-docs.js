/**
 * Node script to move docs from /lib to /docs
 */
var fs = require('fs')
var path = require('path')
var componentsPath = path.join(__dirname, '/../lib/plugins/aws')
var dest = path.join(__dirname, '/../docs/aws/cli')
var componentsList = getSubFolders(componentsPath)

function getSubFolders(dir) {
  return fs.readdirSync(dir).filter(function (x) {
    return x !== '.DS_Store' && x !== 'index.js'
  })
}

function checkForReadMe(directory) {
  var p = path.join(componentsPath, directory, 'README.md')
  if (fs.existsSync(p)) {
    var newName = directory + '.md'
    var newPath = path.join(dest, newName)
    var content = fs.readFileSync(p)
var contentToWrite =`<!-- This file is automatically generated from lib/plugins/aws/${directory}/README.md Please edit it to update this doc -->
${content}`
    fs.writeFileSync(newPath, contentToWrite);
    //fs.createReadStream(p).pipe(fs.createWriteStream(newPath));
  }
}

for (var i = 0; i < componentsList.length; i++) {
  checkForReadMe(componentsList[i])
}
